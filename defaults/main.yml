---
# defaults file for centos7-cui-compliance

# Enable Services Tasks
centos7_cui_compliance_services_tasks: true

# Enable System Settings Tasks
centos7_cui_compliance_system_settings_tasks: true

# Services - Obsolete Services Task Variables
centos7_cui_compliance_services_obsolete_services_tasks: true
services_obsolete_services_uninstall_packages:
  - 'rsh'
  - 'rsh-server'
  - 'telnet'
  - 'telnet-server'
  - 'ypbind'
  - 'ypserv'
  - 'xinetd'
  - 'talk'
  - 'talk-server'

services_obsolete_services_disable_services:
  - 'rlogin.socket'
  - 'rexec.socket'
  - 'rsh.socket'
  - 'telnet.socket'
  - 'ypbind.service'
  - 'xinetd.service'
  - 'zebra.service'
  - 'kdump.service'

# Services - Cron and At Daemons Task Variables
centos7_cui_compliance_services_cron_and_at_daemons_tasks: true

# Services - Network Routing Task Variables
centos7_cui_compliance_services_network_routing_tasks: true

# Services - SSSD Task Variables
centos7_cui_compliance_services_sssd_tasks: true
services_sssd_memcache_timeout: '300'
services_sssd_ssh_known_hosts_timeout: '180'
services_sssd_offline_credentials_expiration: '1'

# Services - Base Services Variables
centos7_cui_compliance_services_base_services_tasks: true

# Services - SSH Server Variables
centos7_cui_compliance_services_ssh_server_tasks: true
services_ssh_server_sshd_set_keepalive: '0'
services_ssh_server_sshd_idle_timeout_value: '600'
services_ssh_server_sshd_approved_macs: 'hmac-sha2-512,hmac-sha2-256,hmac-sha1,hmac-sha1-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com'
services_ssh_server_sshd_approved_ciphers: 'aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc,aes192-cbc,aes256-cbc'

# System Settings - Installing and Maintaining Software Variables
centos7_cui_compliance_system_settings_installing_and_maintaining_software_tasks: true

# System Settings - Configure Syslog Variables
centos7_cui_compliance_system_settings_configure_syslog_tasks: true

# System Settings - Network Configuration and Firewalls Variables
centos7_cui_compliance_system_settings_network_configuration_and_firewalls_tasks: true
system_settings_network_configuration_and_firewalls_disable_ipv6_autoconf: true
system_settings_network_configuration_and_firewalls_sysctl_config:
  - {'name': 'net.ipv6.conf.all.accept_source_route', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv6.conf.default.accept_source_route', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv6.conf.all.forwarding', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv6.conf.all.accept_redirects', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv6.conf.default.accept_redirects', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv6.conf.all.accept_ra', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv6.conf.default.accept_ra', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv6.conf.all.disable_ipv6', 'value': '1', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.conf.default.accept_source_route', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.icmp_ignore_bogus_error_responses', 'value': '1', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.conf.default.accept_redirects', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.conf.default.rp_filter', 'value': '1', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.conf.all.secure_redirects', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.conf.all.accept_source_route', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.tcp_syncookies', 'value': '1', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.conf.all.accept_redirects', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.conf.all.log_martians', 'value': '1', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.conf.all.rp_filter', 'value': '1', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.icmp_echo_ignore_broadcasts', 'value': '1', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.conf.default.secure_redirects', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.conf.default.log_martians', 'value': '1', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.conf.all.send_redirects', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
  - {'name': 'net.ipv4.conf.default.send_redirects', 'value': '0', 'state': 'present', 'sysctl_set': 'yes', 'reload': 'yes'}
system_settings_network_configuration_and_firewalls_ipv6_privacy: false

# System Settings - SELinux Variables
centos7_cui_compliance_system_settings_selinux_tasks: true
system_settings_selinux_policy: 'targeted'
system_settings_selinux_state: 'enforcing'
system_settings_selinux_boolean: true
system_settings_selinux_boolean_list:
  - {'name': 'ssh_sysadm_login', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'selinuxuser_execstack', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'xguest_connect_network', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'gpg_web_anon_write', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'mount_anyfile', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'login_console_enabled', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'cron_can_relabel', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'xdm_write_home', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'logadm_exec_content', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'user_exec_content', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'deny_ptrace', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'guest_exec_content', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'xserver_object_manager', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'xdm_sysadm_login', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'sysadm_exec_content', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'selinuxuser_mysql_connect_enabled', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'kerberos_enabled', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'xguest_mount_media', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'ssh_keysign', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'xserver_execmem', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'cron_userdomain_transition', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'xdm_bind_vnc_tcp_port', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'selinuxuser_rw_noexattrfile', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'deny_execmem', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'ssh_chroot_rw_homedirs', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'abrt_anon_write', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'logging_syslogd_use_tty', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'abrt_handle_event', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'mock_enable_homedirs', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'auditadm_exec_content', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'xguest_exec_content', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'unconfined_login', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'logging_syslogd_can_sendmail', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'selinuxuser_postgresql_connect_enabled', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'daemons_use_tcp_wrapper', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'abrt_upload_watch_anon_write', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'daemons_use_tty', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'selinuxuser_tcp_server', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'staff_exec_content', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'selinuxuser_direct_dri_enabled', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'xserver_clients_write_xshm', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'use_ecryptfs_home_dirs', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'selinuxuser_use_ssh_chroot', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'domain_fd_use', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'selinuxuser_udp_server', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'mmap_low_allowed', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'selinuxuser_share_music', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'selinuxuser_execmod', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'cron_system_cronjob_use_shares', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'secure_mode', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'xguest_use_bluetooth', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'selinuxuser_execheap', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'secure_mode_policyload', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'daemons_dump_core', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'xdm_exec_bootloader', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'fips_mode', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'polyinstantiation_enabled', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'domain_kernel_load_modules', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'secure_mode_insmod', 'state': 'no', 'persistent': 'yes'}
  - {'name': 'selinuxuser_ping', 'state': 'yes', 'persistent': 'yes'}
  - {'name': 'secadm_exec_content', 'state': 'yes', 'persistent': 'yes'}

# System Settings - Account and Access Control Variables
centos7_cui_compliance_system_settings_account_and_access_control_tasks: true
system_settings_account_and_access_control_password_pam_minlen: '15'
system_settings_account_and_access_control_password_pam_maxclassrepeat: '4'
system_settings_account_and_access_control_password_pam_dcredit: '-1'
system_settings_account_and_access_control_password_pam_minclass: '4'
system_settings_account_and_access_control_password_pam_difok: '8'
system_settings_account_and_access_control_password_pam_ocredit: '-1'
system_settings_account_and_access_control_password_pam_lcredit: '-1'
system_settings_account_and_access_control_password_pam_ucredit: '-1'
system_settings_account_and_access_control_user_umask: '077'
system_settings_account_and_access_control_accounts_tmout: '600'
system_settings_account_and_access_control_accounts_fail_delay: '4'
system_settings_account_and_access_control_accounts_max_concurrent_login_sessions: '10'
system_settings_account_and_access_control_accounts_password_minlen_login_defs: '6'
system_settings_account_and_access_control_accounts_password_warn_age_login_defs: '7'
system_settings_account_and_access_control_accounts_password_minimum_age_login_defs: '1'
system_settings_account_and_access_control_accounts_password_maximum_age_login_defs: '180'
system_settings_account_and_access_control_account_disable_post_pw_expiration: '35'
